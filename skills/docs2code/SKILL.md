# Docs-to-Code Generation Skill

> Transform documentation, specifications, and PRDs into production-ready code following the Smart Delta architecture.

---

## Overview

This skill enables Claude to generate production-ready code from:

- **Markdown specifications** → Odoo modules, FastAPI endpoints
- **OpenAPI specs** → Python/TypeScript SDKs
- **PRDs** → Complete module scaffolds
- **Figma Dev Mode exports** → React/Vue components

The skill enforces the **Smart Delta** architecture:
1. **Odoo 18 CE first** (80%)
2. **OCA modules second** (15%)
3. **Custom modules last** (5%, naming: `ipai_*`)

---

## When to Use

Use this skill when you need to:

- Generate an Odoo module from a markdown specification
- Create API client SDKs from OpenAPI definitions
- Scaffold a new module following InsightPulseAI conventions
- Convert PRD sections into code structure
- Validate generated code against source specifications

---

## Behavioral Rules

### GPT-5.2 Pattern Integration

```xml
<output_verbosity_spec>
  <mode>compact</mode>
  <format>tagged</format>
  <rules>
    - Use <generated_file path="..."> blocks for each file
    - Include regeneration headers in ALL files
    - Omit explanations unless explicitly requested
  </rules>
</output_verbosity_spec>

<design_and_scope_constraints>
  <no_scope_drift>
    - Generate ONLY what is specified
    - Do NOT add features not in source
    - Do NOT refactor unrelated code
  </no_scope_drift>
</design_and_scope_constraints>

<high_risk_self_check>
  Before finalizing:
  - [ ] No hardcoded secrets
  - [ ] All files have regeneration headers
  - [ ] Code follows target framework conventions
  - [ ] Tests included for generated code
</high_risk_self_check>
```

### Smart Delta Integration

```yaml
module_naming:
  pattern: "ipai_{module_name}"
  examples:
    - ipai_bir_forms
    - ipai_close_manager
    - ipai_sod_audit

dependency_priority:
  1: "odoo_ce"      # Use native Odoo 18 CE features
  2: "oca_modules"  # Leverage OCA community modules
  3: "custom"       # Only when 1 & 2 insufficient

file_structure:
  - __manifest__.py
  - models/
  - views/
  - security/
  - tests/
  - static/description/icon.png
```

---

## Example Prompts

### Generate Odoo Module from Spec

```
Generate an Odoo 18 module from this specification.

<spec>
Module: BIR 1601C Monthly Remittance
Description: Philippine BIR monthly withholding tax form

Fields:
- company_id: Many2one(res.company), required
- period_start: Date, required
- period_end: Date, required
- gross_compensation: Monetary
- tax_withheld: Monetary, computed from gross_compensation * 0.10
- status: Selection [draft, submitted, filed]

Actions:
- Submit: Change status to 'submitted', validate all fields
- File: Change status to 'filed', lock record
</spec>

Generate:
1. __manifest__.py
2. models/__init__.py
3. models/bir_1601c.py
4. views/bir_1601c_views.xml
5. security/ir.model.access.csv
6. tests/test_bir_1601c.py
```

### Generate from OpenAPI

```
Generate a Python SDK client from this OpenAPI spec.

Use the configuration in tools/openapi-generator/python.yaml.
Package name: ipai_sdk
Include type hints and async support.
```

### Validate Generated Code

```
Validate this generated Odoo module against its source specification.

Check:
1. All fields from spec are present
2. All actions from spec are implemented
3. Security rules are appropriate
4. Tests cover the specified behavior
```

### Multi-File Architecture

```
Generate a complete Odoo module for Month-End Close orchestration.

Requirements:
- Close calendar with state machine (draft, in_progress, review, closed)
- Task templates with dependencies (DAG structure)
- Sign-off workflow with multi-level approval
- Integration with BIR forms modules

Output:
1. First, provide a numbered outline of all files
2. Then generate each file with anchor headers
3. End with a manifest summary
```

---

## Output Format

### Single File

```xml
<generated_file path="odoo/custom_addons/ipai_bir_forms/__manifest__.py">
# =============================================================================
# AUTO-GENERATED by InsightPulseAI Docs-to-Code Pipeline
# Source: docs/specs/modules/ipai_bir_forms.md
# Generated: 2025-12-31
# DO NOT EDIT DIRECTLY - regenerate from source document
# =============================================================================
{
    'name': 'IPAI BIR Forms',
    'version': '18.0.1.0.0',
    ...
}
</generated_file>
```

### Multi-File (with outline)

```xml
<file_outline>
1. __manifest__.py
2. models/__init__.py
3. models/bir_1601c.py
4. views/bir_1601c_views.xml
5. security/ir.model.access.csv
6. tests/test_bir_1601c.py
</file_outline>

<generated_file path="odoo/custom_addons/ipai_bir_forms/__manifest__.py">
### File 1 of 6: __manifest__.py
...
</generated_file>

<generated_file path="odoo/custom_addons/ipai_bir_forms/models/__init__.py">
### File 2 of 6: models/__init__.py
...
</generated_file>

... (remaining files)

<manifest_summary>
Generated 6 files for ipai_bir_forms module:
- 1 manifest
- 2 model files
- 1 view file
- 1 security file
- 1 test file
</manifest_summary>
```

---

## Validation Checklist

Before accepting generated code:

### Scope Validation
- [ ] All generated files are in the specification
- [ ] No extra endpoints/fields/features added
- [ ] Dependencies are minimal and necessary

### Code Quality
- [ ] Regeneration header present in all files
- [ ] Follows Odoo 18 CE conventions
- [ ] No hardcoded values (use config/env)
- [ ] Proper error handling

### Security
- [ ] No SQL injection vectors
- [ ] Access rights properly configured
- [ ] Sensitive fields use appropriate widgets

### Testing
- [ ] Test stubs included for all models
- [ ] Edge cases identified in tests
- [ ] Fixtures use realistic data

---

## Integration with Catalog Resources

From [Eric Vyacheslav AI/ML Catalog](../../docs/catalogs/ERIC_VYACHESLAV_AI_ML_CATALOG.md):

| Pattern | Tool | Usage in This Skill |
|---------|------|---------------------|
| PRD-to-Code | Claude Code for PMs | Epic decomposition flow |
| Repository Intelligence | DeepWiki | Context for existing modules |
| Document Processing | LangExtract | Spec parsing |
| Local RAG | MCP Server | Codebase pattern matching |

---

## Related Resources

- [System Prompt v1](../../docs/prompts/docs-to-code-pipeline-v1.md)
- [Repository Structure](../../docs/prompts/repo-structure-and-workflows.md)
- [Stack Manifest](../../stack.yaml)
- [Technology Stack](../../docs/SCHEMA.md)

---

## Key External Links

- [OpenAPI Generator](https://github.com/OpenAPITools/openapi-generator)
- [Buf (Protobuf)](https://github.com/bufbuild/buf)
- [GraphQL Codegen](https://github.com/dotansimha/graphql-code-generator)
- [Spectral (OpenAPI Linting)](https://github.com/stoplightio/spectral)
- [Odoo 18 Documentation](https://www.odoo.com/documentation/18.0)

---

*Skill version: 1.0.0*
*Last updated: 2025-12-31*
*Category: codegen*
*Tags: odoo, openapi, protobuf, docs2code, smart-delta*
